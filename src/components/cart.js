import React, { useState } from "react"
import Helmet from "react-helmet"
import { useShoppingCart } from 'use-shopping-cart'
import CartItems from "./CartItems"
import Honeyjar from "../images/honey.png"

const Cart = () => {
  const [loading, setLoading] = useState(false);
  const { storeLastClicked, lastClicked, shouldDisplayCart, handleCloseCart, totalPrice, formattedTotalPrice, redirectToCheckout, clearCart } = useShoppingCart();
  const priceWithShipping = totalPrice / 100 + 4.90;
return (
  <>
    <Helmet>
      <html lang="de" className={`${shouldDisplayCart ? 'is-clipped' : ''}`} />
    </Helmet>
    <div className="cart-wrapper">
    <div onClick={() => {
      handleCloseCart()
      storeLastClicked('close')
    }} className={`cart-backdrop ${shouldDisplayCart ? 'visible' : ''}`} />
    <div className={`cart ${shouldDisplayCart ? 'visible' : ''}`}>
      <button onClick={() => {
      handleCloseCart()
      storeLastClicked('close')
    }} className="button is-medium is-primary is-fullwidth" style={{ justifyContent: 'flex-start', borderRadius: '0px', backgroundColor: '#f4f4f4 !important' }}>
        <span className="icon">
          <svg width="12" height="18" viewBox="0 0 12 18" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M10.5 17L2.51472 9.01472L10.5 1.02944" stroke="currentcolor" strokeWidth="2.5" />
          </svg>
        </span>
        <span>Weiter einkaufen</span>
      </button>
      <div className="m-5">
        {lastClicked === 'add' ?
        <div className="notification is-success is-light">
          <div className="columns is-variable is-2 is-vcentered is-mobile">
            <div className="column is-narrow">
              <svg width="25" height="20" viewBox="0 0 25 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M1.42065 8.96403L10.4362 17.1256L22.8683 1.84652" stroke="#2DB872" strokeWidth="4" />
              </svg>
            </div>
            <div className="column">
              Der Artikel wurde erfolgreich in den Warenkorb gelegt
            </div>
          </div>
        </div>
        : ''}
        <CartItems />
        <div className="level is-mobile mb-1">
          <div className="level-left">
            <div className="level-item">
              <p className="is-size-5">Summe</p>
            </div>
          </div>
          <div className="level-rigth">
            <div className="level-item">
              <p className="is-size-5">{formattedTotalPrice}</p>
            </div>
          </div>
        </div>
        <div className="level is-mobile mb-2">
          <div className="level-left">
            <div className="level-item">
              <p className="is-size-5 has-text-light">Versandkosten</p>
            </div>
          </div>
          <div className="level-rigth">
            <div className="level-item">
              <p className="is-size-5 has-text-light">4,90 €</p>
            </div>
          </div>
        </div>
        <hr />
        <div className="level is-mobile mb-1">
          <div className="level-left">
            <div className="level-item">
              <p className="is-size-5 has-text-weight-bold">Gesamtsumme</p>
            </div>
          </div>
          <div className="level-rigth">
            <div className="level-item">
              <p className="is-size-5 has-text-weight-bold">{priceWithShipping.toLocaleString('de-DE', { style: 'currency', currency: 'EUR' })}</p>
            </div>
          </div>
        </div>
        <div className="level is-mobile mb-0">
          <div className="level-left">
            <div className="level-item">
              <p className="is-size-6 has-text-light">inkl. 7 % MwSt.</p>
            </div>
          </div>
          <div className="level-rigth">
            <div className="level-item">
              <p className="is-size-6 has-text-light">0,92 €</p>
            </div>
          </div>
        </div>
        <div className="level is-mobile mt-0">
          <div className="level-left">
            <div className="level-item">
              <p className="is-size-6 has-text-light">inkl. 19 % MwSt.</p>
            </div>
          </div>
          <div className="level-rigth">
            <div className="level-item">
              <p className="is-size-6 has-text-light">4,92 €</p>
            </div>
          </div>
        </div>
        <div className="buttons">
          <button className={`button is-medium has-text-white is-info is-fullwidth has-text-weight-bold ${loading ? 'is-loading' : ''}`}
            disabled={loading}
            onClick={() => {
              setLoading(true)
              redirectToCheckout()
          }}>
            <span>Zur Kasse</span>
            <span className="icon">
              <svg width="19" height="18" viewBox="0 0 19 18" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M8.49976 17L16.485 9.01472L8.49976 1.02944" stroke="currentcolor" strokeWidth="3" />
              </svg>
            </span>
          </button>
          <button className="button paypal is-medium is-warning is-fullwidth has-text-weight-bold">
            <span>Zahlen mit</span>
            <span className="icon">
              <svg width="128" height="33" viewBox="0 0 128 33" fill="none" xmlns="http://www.w3.org/2000/svg">
                <g filter="url(#filter0_d)">
                  <path d="M47.4697 6.93285H40.4444C40.2118 6.9327 39.9869 7.01562 39.81 7.16667C39.6332 7.31771 39.5161 7.52696 39.4798 7.75669L36.6385 25.7714C36.6254 25.8549 36.6306 25.9404 36.6538 26.0218C36.6769 26.1032 36.7174 26.1786 36.7724 26.2428C36.8275 26.307 36.8958 26.3586 36.9727 26.3939C37.0496 26.4292 37.1332 26.4474 37.2179 26.4473H40.5718C40.8045 26.4474 41.0296 26.3643 41.2065 26.2131C41.3834 26.0618 41.5003 25.8523 41.5364 25.6224L42.3027 20.7636C42.3387 20.5338 42.4555 20.3245 42.6322 20.1732C42.8088 20.022 43.0337 19.9388 43.2662 19.9387H45.4902C50.1179 19.9387 52.7887 17.6993 53.4862 13.2617C53.8005 11.3202 53.4996 9.79473 52.5905 8.7264C51.592 7.5533 49.821 6.93285 47.4697 6.93285V6.93285ZM48.2802 13.5123C47.896 16.0331 45.9699 16.0331 44.1075 16.0331H43.0474L43.7911 11.3253C43.8129 11.1876 43.8831 11.0621 43.9891 10.9716C44.0952 10.881 44.23 10.8312 44.3695 10.8312H44.8554C46.124 10.8312 47.3207 10.8312 47.9391 11.5544C48.3079 11.9858 48.4209 12.6268 48.2802 13.5123V13.5123ZM68.4695 13.4312H65.1053C64.9659 13.4312 64.831 13.4809 64.725 13.5715C64.6189 13.6621 64.5487 13.7875 64.527 13.9253L64.378 14.8662L64.1428 14.5252C63.4145 13.4681 61.7904 13.1148 60.1694 13.1148C56.4518 13.1148 53.2767 15.9304 52.6583 19.8801C52.3367 21.8504 52.7939 23.7343 53.9115 25.0482C54.9367 26.2562 56.4036 26.7596 58.1488 26.7596C61.1443 26.7596 62.8053 24.8335 62.8053 24.8335L62.6553 25.7683C62.642 25.8518 62.6469 25.9373 62.6697 26.0188C62.6926 26.1003 62.7328 26.1759 62.7877 26.2403C62.8426 26.3048 62.9108 26.3566 62.9876 26.3921C63.0644 26.4277 63.148 26.4461 63.2326 26.4463H66.263C66.4957 26.4464 66.7208 26.3633 66.8977 26.212C67.0746 26.0608 67.1916 25.8513 67.2276 25.6214L69.0458 14.1071C69.0592 14.0237 69.0543 13.9384 69.0315 13.8571C69.0087 13.7757 68.9685 13.7003 68.9137 13.6361C68.8589 13.5718 68.7908 13.5202 68.7141 13.4848C68.6374 13.4494 68.554 13.4311 68.4695 13.4312V13.4312ZM63.7802 19.9788C63.4556 21.9007 61.9301 23.1909 59.9845 23.1909C59.0076 23.1909 58.2269 22.8776 57.7256 22.2839C57.2284 21.6943 57.0394 20.855 57.1976 19.9202C57.5007 18.0147 59.0518 16.6824 60.9676 16.6824C61.9229 16.6824 62.6995 16.9998 63.2111 17.5987C63.7237 18.2037 63.9271 19.0481 63.7802 19.9788V19.9788ZM86.3866 13.4312H83.0059C82.8465 13.4314 82.6895 13.4706 82.5487 13.5452C82.4078 13.6198 82.2872 13.7277 82.1975 13.8595L77.5349 20.7276L75.5585 14.1276C75.4978 13.9263 75.3739 13.7499 75.2052 13.6245C75.0365 13.499 74.8319 13.4313 74.6216 13.4312H71.2995C71.2063 13.4309 71.1143 13.4529 71.0313 13.4954C70.9483 13.5379 70.8766 13.5996 70.8222 13.6753C70.7679 13.7511 70.7324 13.8388 70.7188 13.931C70.7051 14.0233 70.7137 14.1174 70.7438 14.2057L74.4675 25.1334L70.9667 30.0755C70.9045 30.1631 70.8676 30.2662 70.86 30.3734C70.8525 30.4806 70.8746 30.5878 70.9239 30.6832C70.9733 30.7787 71.0479 30.8588 71.1397 30.9146C71.2315 30.9705 71.3369 31 71.4444 31H74.8209C74.9786 31.0002 75.1339 30.9622 75.2736 30.8892C75.4134 30.8162 75.5333 30.7104 75.6232 30.5809L86.8673 14.3505C86.9283 14.2627 86.964 14.1599 86.9707 14.0532C86.9774 13.9465 86.9547 13.8401 86.9052 13.7454C86.8556 13.6506 86.7811 13.5713 86.6897 13.5159C86.5983 13.4605 86.4935 13.4312 86.3866 13.4312V13.4312Z" fill="#253B80"/>
                  <path d="M97.5793 6.93288H90.553C90.3206 6.93298 90.0959 7.01601 89.9192 7.16704C89.7426 7.31806 89.6256 7.52717 89.5894 7.75673L86.7481 25.7714C86.7349 25.8548 86.7399 25.9402 86.7629 26.0215C86.7858 26.1028 86.8261 26.1782 86.881 26.2424C86.9358 26.3067 87.004 26.3583 87.0807 26.3936C87.1574 26.429 87.2409 26.4473 87.3254 26.4473H90.931C91.0937 26.4471 91.2509 26.3888 91.3744 26.283C91.498 26.1771 91.5797 26.0307 91.6049 25.87L92.4113 20.7636C92.4472 20.5339 92.5641 20.3245 92.7408 20.1733C92.9174 20.022 93.1423 19.9389 93.3748 19.9387H95.5978C100.226 19.9387 102.896 17.6994 103.595 13.2617C103.91 11.3202 103.607 9.79476 102.698 8.72644C101.701 7.55333 99.9306 6.93288 97.5793 6.93288V6.93288ZM98.3898 13.5123C98.0066 16.0332 96.0806 16.0332 94.2171 16.0332H93.1581L93.9028 11.3253C93.9242 11.1876 93.9941 11.0621 94.1 10.9714C94.2059 10.8808 94.3407 10.8311 94.4801 10.8312H94.966C96.2336 10.8312 97.4314 10.8312 98.0498 11.5544C98.4185 11.9859 98.5305 12.6269 98.3898 13.5123V13.5123ZM118.578 13.4312H115.216C115.076 13.4308 114.942 13.4805 114.836 13.5711C114.73 13.6618 114.66 13.7875 114.639 13.9253L114.49 14.8662L114.253 14.5252C113.525 13.4682 111.902 13.1148 110.281 13.1148C106.564 13.1148 103.389 15.9305 102.771 19.8802C102.45 21.8504 102.906 23.7344 104.023 25.0482C105.05 26.2562 106.515 26.7596 108.261 26.7596C111.256 26.7596 112.917 24.8335 112.917 24.8335L112.767 25.7683C112.754 25.8521 112.759 25.9377 112.782 26.0194C112.805 26.101 112.845 26.1767 112.9 26.2411C112.955 26.3056 113.024 26.3574 113.101 26.3928C113.178 26.4282 113.262 26.4465 113.346 26.4463H116.376C116.608 26.4462 116.833 26.363 117.01 26.2117C117.186 26.0605 117.303 25.8512 117.339 25.6214L119.158 14.1071C119.171 14.0235 119.166 13.938 119.143 13.8566C119.12 13.7752 119.079 13.6998 119.024 13.6356C118.969 13.5714 118.9 13.5199 118.823 13.4846C118.746 13.4493 118.663 13.4311 118.578 13.4312V13.4312ZM113.889 19.9788C113.566 21.9008 112.039 23.191 110.093 23.191C109.118 23.191 108.335 22.8777 107.834 22.2839C107.337 21.6943 107.15 20.855 107.306 19.9202C107.611 18.0147 109.16 16.6824 111.076 16.6824C112.031 16.6824 112.808 16.9998 113.32 17.5987C113.834 18.2037 114.038 19.0481 113.889 19.9788V19.9788ZM122.544 7.42698L119.661 25.7714C119.648 25.8548 119.653 25.9402 119.676 26.0215C119.698 26.1028 119.739 26.1782 119.794 26.2424C119.849 26.3067 119.917 26.3583 119.993 26.3936C120.07 26.429 120.154 26.4473 120.238 26.4473H123.137C123.619 26.4473 124.028 26.0981 124.102 25.6224L126.945 7.6088C126.958 7.5253 126.953 7.43994 126.93 7.35857C126.907 7.2772 126.867 7.20176 126.812 7.13744C126.757 7.07312 126.689 7.02143 126.612 6.98595C126.536 6.95046 126.452 6.932 126.368 6.93185H123.122C122.982 6.93235 122.848 6.98244 122.742 7.07317C122.636 7.1639 122.566 7.28932 122.544 7.42698Z" fill="#179BD7"/>
                  <path d="M7.46391 29.948L8.00116 26.5355L6.80443 26.5078H1.0899L5.06121 1.32712C5.07303 1.25018 5.11211 1.18006 5.17131 1.12952C5.23052 1.07899 5.30592 1.05141 5.38376 1.05182H15.0192C18.2181 1.05182 20.4256 1.71747 21.5782 3.03131C22.1185 3.64765 22.4626 4.29173 22.629 5.00052C22.8037 5.74424 22.8067 6.6328 22.6362 7.71654L22.6239 7.79564V8.49005L23.1642 8.79617C23.5767 9.00515 23.9475 9.28784 24.2582 9.63028C24.7205 10.1573 25.0194 10.827 25.1458 11.6211C25.2762 12.4377 25.2331 13.4095 25.0194 14.5097C24.7729 15.7752 24.3743 16.8774 23.836 17.7794C23.3611 18.5873 22.7225 19.2871 21.9613 19.8338C21.2464 20.3413 20.3968 20.7265 19.4364 20.973C18.5057 21.2155 17.4446 21.3377 16.2807 21.3377H15.5308C14.9946 21.3377 14.4738 21.5308 14.0649 21.877C13.6567 22.2269 13.3859 22.7103 13.3007 23.2412L13.2442 23.5483L12.295 29.5628L12.2519 29.7837C12.2406 29.8535 12.2211 29.8884 12.1923 29.9121C12.1644 29.9348 12.1297 29.9475 12.0937 29.948H7.46391Z" fill="#253B80"/>
                  <path d="M23.6759 7.87582C23.6472 8.0597 23.6143 8.24768 23.5773 8.4408C22.3066 14.9648 17.9593 17.2185 12.4071 17.2185H9.58016C8.90116 17.2185 8.32899 17.7116 8.22318 18.3814L6.77581 27.5608L6.36594 30.1628C6.34961 30.266 6.35584 30.3715 6.38421 30.4721C6.41258 30.5726 6.4624 30.6659 6.53025 30.7453C6.5981 30.8248 6.68237 30.8886 6.77725 30.9324C6.87213 30.9762 6.97537 30.9989 7.07987 30.9989H12.0938C12.6876 30.9989 13.1919 30.5675 13.2854 29.982L13.3347 29.7272L14.2787 23.7364L14.3394 23.4077C14.4318 22.8201 14.9372 22.3886 15.531 22.3886H16.2808C21.1386 22.3886 24.9415 20.4163 26.0529 14.709C26.5173 12.3248 26.2769 10.334 25.0483 8.93388C24.6589 8.50076 24.1939 8.14222 23.6759 7.87582V7.87582Z" fill="#179BD7"/>
                  <path d="M22.3464 7.34567C21.9407 7.22829 21.5279 7.13669 21.1106 7.07139C20.2861 6.94467 19.4527 6.88388 18.6185 6.88957H11.0663C10.7789 6.88935 10.5009 6.99196 10.2825 7.17885C10.0642 7.36574 9.91987 7.62459 9.87573 7.90859L8.26913 18.0844L8.2229 18.3813C8.27295 18.0573 8.43729 17.762 8.68619 17.5487C8.93508 17.3354 9.2521 17.2183 9.57988 17.2184H12.4068C17.9591 17.2184 22.3063 14.9637 23.577 8.4407C23.615 8.24758 23.6469 8.0596 23.6756 7.87572C23.3403 7.69989 22.9909 7.55248 22.6309 7.43504C22.5366 7.40372 22.4417 7.37393 22.3464 7.34567V7.34567Z" fill="#222D65"/>
                  <path d="M9.87583 7.9087C9.9196 7.62462 10.0638 7.36565 10.2823 7.17885C10.5007 6.99206 10.779 6.88982 11.0664 6.89071H18.6186C19.5134 6.89071 20.3485 6.94926 21.1107 7.07253C21.6265 7.15359 22.1352 7.27483 22.6321 7.43515C23.007 7.55944 23.3552 7.70634 23.6768 7.87583C24.0548 5.4649 23.6737 3.82338 22.3701 2.33697C20.933 0.700576 18.3392 0 15.0202 0H5.38475C4.70677 0 4.12844 0.493074 4.02366 1.16386L0.0102407 26.6034C-0.00845316 26.7215 -0.0013408 26.8423 0.0310885 26.9574C0.0635178 27.0725 0.120494 27.1792 0.198099 27.2702C0.275704 27.3611 0.372095 27.4342 0.480641 27.4844C0.589188 27.5346 0.707314 27.5606 0.826894 27.5608H6.77563L8.26923 18.0845L9.87583 7.9087V7.9087Z" fill="#253B80"/>
                </g>
                <defs>
                  <filter id="filter0_d" x="0" y="0" width="127.5" height="32.5" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
                    <feFlood floodOpacity="0" result="BackgroundImageFix"/>
                    <feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"/>
                    <feOffset dx="0.6" dy="1.6"/>
                    <feColorMatrix type="matrix" values="0 0 0 0 1 0 0 0 0 1 0 0 0 0 1 0 0 0 1 0"/>
                    <feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow"/>
                    <feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow" result="shape"/>
                  </filter>
                </defs>
              </svg>                                
            </span>
          </button>
          <button className="button is-medium is-light is-fullwidth is-outlined has-text-weight-bold">
            <span>Warenkorb bearbeiten</span>
          </button>
          <button className="button is-fullwidth is-ghost" onClick={() => {
            clearCart()
            storeLastClicked('close')
          }}>
            Warenkorb löschen
          </button>
        </div>
      </div>
    </div>
  </div>
  </>
)
}

export default Cart

